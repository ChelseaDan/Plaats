var underscore=angular.module("underscore",[]),app=angular.module("App",["ui.router","App.common","App.home","angularSpinners","underscore"]);app.config(function(e,o){o.otherwise("/home"),e.state("home",{url:"/home",templateUrl:"/home",controller:"homeController",controllerAs:"vm"}).state("properties",{url:"/properties",templateUrl:"/home",controller:"homeController",controllerAs:"vm"}).state("account",{url:"/account",templateUrl:"/account",controller:"accountController",controllerAs:"vm"}).state("login",{url:"/login",templateUrl:"/login",controller:"loginController",controllerAs:"vm"})});var App;!function(e){var o=function(){function e(e,o){this.$scope=e,this.loginService=o,this.user=this.loginService.getUser()}return e.prototype.getMessages=function(){return this.resetAllViews(),this.viewMessages=!0,this.messages=[{id:1,from:"sender1",title:"Hello world",content:"This is a message"},{id:2,from:"sender2",title:"Hello world2",content:"This is the second message"},{id:3,from:"sender3",title:"Hello world3",content:"This is the third message"}],this.messages},e.prototype.getMessageInfo=function(e){this.viewEmailInfo=!0;var o=_.filter(this.messages,function(o){return o.id==e});this.selectedMessage=o[0],console.log(this.selectedMessage)},e.prototype.getAccountInfo=function(){this.resetAllViews(),this.viewAccountInfo=!0,this.user=this.loginService.getUser()},e.prototype.resetAllViews=function(){this.viewAccountInfo=!1,this.viewEmailInfo=!1,this.viewMessages=!1},e.$inject=["$scope","loginService"],e}();e.AccountController=o}(App||(App={})),angular.module("App").controller("accountController",App.AccountController);var module=angular.module("App.common",["angularSpinners"]),App;!function(e){function o(){return{restrict:"E",templateUrl:"/scripts/controllers/common/login.html",scope:{},controller:"loginController",controllerAs:"vm",bindToController:!0}}e.LoginDirective=o;var t=function(){function e(e,o,t,n){this.$scope=e,this.$http=o,this.loginService=t,this.$location=n,this.logInSelected=!1,this.signInSelected=!0,this.displaySpinner=!1}return e.prototype.submitNewUserDetails=function(){var e=this;this.displaySpinner=!0;var o={firstName:this.firstName,lastName:this.lastName,emailAddress:this.emailAddress,password:this.password};this.loginService.registerUser(o).then(function(o){e.$location.url("/account")},function(o){console.log("error in registering so loading /login"),e.$location.url("/login")}).finally(function(){this.displaySpinner=!1})},e.prototype.submitLogInDetails=function(){var e=this;this.displaySpinner=!0;var o={emailAddress:this.emailAddress,password:this.password};this.loginService.existingUser(o).then(function(o){e.$location.url("/account")}).finally(function(){this.displaySpinner=!1})},e.prototype.signedIn=function(){return this.loginService.getSignedIn()},e.prototype.signIn=function(){this.signInSelected=!0,this.logInSelected=!1},e.prototype.logIn=function(){this.logInSelected=!0,this.signInSelected=!1},e.$inject=["$scope","$http","loginService","$location"],e}();e.LoginController=t}(App||(App={})),angular.module("App.common").controller("loginController",App.LoginController).directive("logIn",App.LoginDirective);var App;!function(e){var o=function(){function e(e){this.$http=e,this.signedIn=!1,this.token=""}return e.prototype.registerUser=function(e){var o=this;return this.$http.post("/api/accounts/register",e,{withCredentials:!0}).then(function(e){console.log(e),o.setSignedIn()},function(e){console.log("registerUser error occurred.")})},e.prototype.existingUser=function(e){var o=this;return this.$http.post("/api/accounts/login",e,{withCredentials:!0}).then(function(e){console.log(e),o.setSignedIn()},function(e){console.log("existingUser error occurred.")})},e.prototype.setSignedIn=function(){this.signedIn=!0},e.prototype.getSignedIn=function(){return this.signedIn},e.prototype.setToken=function(e){this.token=e},e.prototype.getToken=function(){return this.token},e.prototype.getUser=function(){return{userName:"Daniel Graaf",emailAddress:"dan.graaf@yahoo.co.uk"}},e.inject=["$http"],e}();e.LoginService=o}(App||(App={})),angular.module("App.common").service("loginService",App.LoginService);var App;!function(e){function o(){return{restrict:"E",templateUrl:"/scripts/controllers/common/navbar.html",scope:{},controller:"navbarController",controllerAs:"vm",bindToController:!0}}e.NavbarDirective=o;var t=function(){function e(e,o){this.$scope=e,this.loginService=o}return e.prototype.isSignedIn=function(){return this.loginService.getSignedIn()},e.$inject=["$scope","loginService"],e}();e.NavbarController=t}(App||(App={})),angular.module("App.common").controller("navbarController",App.NavbarController).directive("navBar",App.NavbarDirective);var App;!function(e){var o=function(){function e(){}return e}();e.User=o}(App||(App={}));var module=angular.module("App.home",[]),App;!function(e){var o;!function(e){function o(){return{restrict:"E",templateUrl:"/scripts/controllers/home/home.html",scope:{},controller:"homeController",controllerAs:"vm",bindToController:!0}}e.HomeDirective=o;var t=function(){function e(){console.log("Constructed home controller")}return e}();e.HomeController=t}(o=e.home||(e.home={}))}(App||(App={})),angular.module("App.home").controller("homeController",App.home.HomeController).directive("home",App.home.HomeDirective);